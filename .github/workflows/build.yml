name: Build

on:
  push:
  pull_request:
  workflow_dispatch:
  schedule:
    - cron: 0 20 * * *


jobs:
  build_linux:
    name: Linux
    runs-on: ubuntu-latest
    steps:
      - uses: laytan/setup-odin@v2
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          release: false

      - uses: actions/checkout@v4

      - name: Symlink libclang.so (Linux)
        run: sudo ln -s libclang-18.so.1 /lib/x86_64-linux-gnu/libclang.so
        working-directory: ${{ env.LLVM_PATH }}/lib

      - name: Build bindgen
        run: |
          odin build src -out:bindgen.exe -vet -strict-style
      
      - name: Raylib
        run: |
          ./bindgen.exe examples/raylib
          odin check examples/raylib/test -vet -strict-style

      - name: Box2D 
        run: |
          ./bindgen.exe examples/box2d
          odin check examples/box2d/test -vet -strict-style

      - name: ufbx
        run: |
          ./bindgen.exe examples/ufbx
          odin check examples/ufbx/test -vet -strict-style

      - name: joltc
        run: |
          ./bindgen.exe examples/joltc
          odin check examples/joltc/jolt -vet -strict-style -no-entry-point 

